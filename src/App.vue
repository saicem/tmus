<script lang="ts" setup>
import { i18n } from "@/script/i18n.ts"
import zhCn from "element-plus/es/locale/lang/zh-cn"
import en from "element-plus/es/locale/lang/en"
import { configStore, passiveStore, updateDialogStore } from "@/script/state.ts"
import { fetchUpdate } from "@/script/cmd.ts"

onMounted(async () => {
  if (configStore.autoCheckUpdate) {
    let update = await fetchUpdate()
    if (update != null) {
      updateDialogStore.meta = update
      updateDialogStore.show = true
    }
  }
})
</script>

<template>
  <update-dialog />
  <el-config-provider :locale="passiveStore.lang === 'en' ? en : zhCn">
    <div :class="passiveStore.theme">
      <TitleBar data-tauri-drag-region />
      <div data-tauri-drag-region style="height: 60px"></div>
      <el-container>
        <el-aside width="200px">
          <el-scrollbar>
            <el-menu default-active="'1'">
              <router-link to="/">
                <el-menu-item index="1">
                  <svg
                    width="12"
                    height="12"
                    viewBox="0 0 12 12"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M8.79866 12H7.02776C6.74366 12 6.51316 11.7681 6.51316 11.4821V7.9591C6.51316 7.935 6.51336 7.9115 6.51376 7.8889H5.48506C5.48526 7.9118 5.48556 7.9353 5.48556 7.9591V11.4821C5.48556 11.768 5.25496 12 4.97086 12H3.20006C2.19126 12 1.37056 11.1095 1.37056 10.0146V7.2036H1.27586C0.739055 7.2036 0.296656 6.9284 0.0925556 6.4671C-0.0746444 6.0867 -0.0564445 5.4768 0.495555 4.9024L4.65516 0.5742C5.01186 0.2038 5.48926 0 5.99956 0C6.50986 0 6.98716 0.2038 7.34366 0.5739L11.5039 4.9021C12.058 5.4784 12.0749 6.089 11.906 6.4682C11.7042 6.9277 11.2617 7.2034 10.7233 7.2034H10.6285V10.0146C10.6282 11.1095 9.80746 12 8.79866 12ZM7.54266 10.9643H8.79876C9.29306 10.9643 9.59886 10.4714 9.59886 10.0146V6.6856C9.59886 6.3998 9.82946 6.1677 10.1136 6.1677H10.723C10.8898 6.1677 10.9392 6.1068 10.9652 6.047C10.9847 5.9931 10.9677 5.8346 10.7636 5.6225L6.60396 1.2946C6.28326 0.961 5.71616 0.961 5.39476 1.2948L1.23536 5.6226C1.03106 5.8352 1.01436 5.9944 1.03416 6.0489C1.05936 6.1062 1.10926 6.1677 1.27556 6.1677H1.88526C2.16936 6.1677 2.39996 6.3996 2.39996 6.6856V10.0147C2.39996 10.4715 2.70566 10.9644 3.20006 10.9644H4.45616L4.45466 7.8395C4.45006 7.6052 4.44436 7.3135 4.66906 7.0831C4.89346 6.8529 5.19946 6.8529 5.29976 6.8529H6.69926C6.79986 6.8529 7.10556 6.8529 7.32996 7.0831C7.55436 7.3136 7.54876 7.6053 7.54416 7.8395L7.54266 7.9592V10.9643Z"
                      fill="currentColor"
                    />
                  </svg>
                  <span style="margin-left: 8px">
                    {{ i18n.navigateMenu.home }}
                  </span>
                </el-menu-item>
              </router-link>
              <router-link to="/timeline">
                <el-menu-item index="2">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 16 16"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M7.99999 1.455C6.70551 1.455 5.4401 1.83886 4.36378 2.55803C3.28746 3.27721 2.44857 4.2994 1.9532 5.49534C1.45782 6.69128 1.32821 8.00726 1.58075 9.27687C1.83329 10.5465 2.45664 11.7127 3.37198 12.628C4.28731 13.5434 5.45352 14.1667 6.72312 14.4192C7.99273 14.6718 9.30871 14.5422 10.5047 14.0468C11.7006 13.5514 12.7228 12.7125 13.442 11.6362C14.1611 10.5599 14.545 9.29448 14.545 8C14.5431 6.26473 13.853 4.60106 12.626 3.37403C11.3989 2.14701 9.73526 1.45685 7.99999 1.455ZM7.99999 13.235C6.96441 13.235 5.95208 12.9279 5.09102 12.3526C4.22997 11.7772 3.55886 10.9595 3.16256 10.0027C2.76626 9.04598 2.66257 7.99319 2.8646 6.97751C3.06663 5.96182 3.56531 5.02886 4.29758 4.29659C5.02985 3.56432 5.96281 3.06564 6.9785 2.86361C7.99418 2.66158 9.04697 2.76527 10.0037 3.16157C10.9605 3.55787 11.7782 4.22898 12.3536 5.09004C12.9289 5.95109 13.236 6.96342 13.236 7.999C13.2344 9.38719 12.6822 10.7181 11.7006 11.6997C10.719 12.6813 9.38818 13.2334 7.99999 13.235Z"
                      fill="currentColor"
                    />
                    <path
                      d="M8 8.999C7.81435 8.999 7.6363 8.92525 7.50503 8.79397C7.37375 8.66269 7.3 8.48465 7.3 8.299V5.111C7.3 4.92534 7.37375 4.7473 7.50503 4.61602C7.6363 4.48475 7.81435 4.411 8 4.411C8.18565 4.411 8.3637 4.48475 8.49498 4.61602C8.62625 4.7473 8.7 4.92534 8.7 5.111V7.6H10.2C10.3857 7.6 10.5637 7.67375 10.695 7.80502C10.8263 7.9363 10.9 8.11434 10.9 8.3C10.9 8.48565 10.8263 8.66369 10.695 8.79497C10.5637 8.92625 10.3857 9 10.2 9L8 8.999Z"
                      fill="currentColor"
                    />
                  </svg>
                  <span style="margin-left: 8px">
                    {{ i18n.navigateMenu.timeline }}
                  </span>
                </el-menu-item>
              </router-link>
              <router-link to="/statistic">
                <el-menu-item index="3">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 16 16"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <g clip-path="url(#clip0_2_8355)">
                      <path
                        d="M3 8V12H1V8H3ZM3 7H1C0.448438 7 0 7.44844 0 8V12C0 12.5516 0.448438 13 1 13H3C3.55156 13 4 12.5516 4 12V8C4 7.44844 3.55156 7 3 7Z"
                        fill="currentColor"
                      />
                      <path
                        d="M9 1V12H7V1H9ZM9 0H7C6.44844 0 6 0.448438 6 1V12C6 12.5516 6.44844 13 7 13H9C9.55156 13 10 12.5516 10 12V1C10 0.448438 9.55156 0 9 0Z"
                        fill="currentColor"
                      />
                      <path
                        d="M15 4V12H13V4H15ZM15 3H13C12.4484 3 12 3.44844 12 4V12C12 12.5516 12.4484 13 13 13H15C15.5516 13 16 12.5516 16 12V4C16 3.44844 15.5516 3 15 3Z"
                        fill="currentColor"
                      />
                      <path
                        d="M15.5 15H0.5C0.223437 15 0 14.7766 0 14.5C0 14.2234 0.223437 14 0.5 14H15.5C15.7766 14 16 14.2234 16 14.5C16 14.7766 15.7766 15 15.5 15Z"
                        fill="currentColor"
                      />
                    </g>
                    <defs>
                      <clipPath id="clip0_2_8355">
                        <rect width="16" height="16" fill="white" />
                      </clipPath>
                    </defs>
                  </svg>
                  <span style="margin-left: 8px">
                    {{ i18n.navigateMenu.statistic }}
                  </span>
                </el-menu-item>
              </router-link>
              <router-link to="/application">
                <el-menu-item index="4">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 16 16"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M7.59547 8.40453V13.2591C7.59547 13.4184 7.56408 13.5763 7.50309 13.7235C7.4421 13.8707 7.3527 14.0045 7.24 14.1172C7.1273 14.2299 6.99351 14.3193 6.84627 14.3803C6.69902 14.4413 6.54121 14.4727 6.38183 14.4727H2.74094C2.41906 14.4727 2.11037 14.3448 1.88278 14.1172C1.65518 13.8896 1.52731 13.5809 1.52731 13.2591V9.61817C1.52731 9.2963 1.65518 8.98761 1.88278 8.76001C2.11037 8.53241 2.41906 8.40455 2.74094 8.40455L7.59547 8.40453ZM13.2591 8.40453C13.4184 8.40453 13.5763 8.43592 13.7235 8.49692C13.8707 8.55791 14.0045 8.6473 14.1172 8.76C14.2299 8.8727 14.3193 9.00649 14.3803 9.15373C14.4413 9.30098 14.4727 9.4588 14.4727 9.61817V13.2591C14.4727 13.5809 14.3448 13.8896 14.1172 14.1172C13.8896 14.3448 13.5809 14.4727 13.2591 14.4727H9.61817C9.2963 14.4727 8.98761 14.3448 8.76001 14.1172C8.53241 13.8896 8.40455 13.5809 8.40455 13.2591V8.40453H13.2591ZM6.38183 9.61817H2.74094V13.2591H6.38183V9.61817ZM13.2591 9.61817H9.61817V13.2591H13.2591V9.61817ZM6.38183 1.52731C6.7037 1.52731 7.01239 1.65518 7.23999 1.88278C7.46759 2.11037 7.59545 2.41906 7.59545 2.74094V7.59547H2.74094C2.58156 7.59547 2.42375 7.56408 2.2765 7.50309C2.12926 7.44209 1.99547 7.3527 1.88277 7.24C1.77007 7.1273 1.68068 6.99351 1.61969 6.84627C1.5587 6.69902 1.52731 6.54121 1.52731 6.38183V2.74094C1.52731 2.41906 1.65518 2.11037 1.88278 1.88278C2.11037 1.65518 2.41906 1.52731 2.74094 1.52731H6.38183ZM11.4386 1.52731C12.2433 1.52731 13.015 1.84697 13.584 2.41597C14.153 2.98497 14.4727 3.7567 14.4727 4.56138C14.4727 5.36607 14.153 6.1378 13.584 6.7068C13.015 7.27579 12.2433 7.59545 11.4386 7.59545C10.6339 7.59545 9.86221 7.27579 9.29321 6.7068C8.72422 6.1378 8.40456 5.36607 8.40456 4.56138C8.40456 3.7567 8.72422 2.98497 9.29321 2.41597C9.86221 1.84697 10.6339 1.52731 11.4386 1.52731ZM6.38183 2.74094H2.74094V6.38183H6.38183V2.74094ZM11.4386 2.74094C10.9558 2.74094 10.4928 2.93273 10.1514 3.27413C9.80998 3.61553 9.61818 4.07857 9.61818 4.56138C9.61818 5.0442 9.80998 5.50723 10.1514 5.84863C10.4928 6.19003 10.9558 6.38183 11.4386 6.38183C11.9214 6.38183 12.3845 6.19003 12.7259 5.84863C13.0673 5.50723 13.2591 5.0442 13.2591 4.56138C13.2591 4.07857 13.0673 3.61553 12.7259 3.27413C12.3845 2.93273 11.9214 2.74094 11.4386 2.74094Z"
                      fill="currentColor"
                    />
                  </svg>
                  <span style="margin-left: 8px">
                    {{ i18n.navigateMenu.application }}
                  </span>
                </el-menu-item>
              </router-link>
              <router-link to="/setting">
                <el-menu-item index="5">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 16 16"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M1 7.41718C1.01875 7.26093 1.07969 7.10624 1.18594 6.97343C1.29219 6.84062 1.42812 6.74687 1.57812 6.69531L2.92656 6.21562C2.99219 6.03281 3.06562 5.85156 3.15156 5.67499L2.5375 4.38124C2.47031 4.23906 2.43906 4.07656 2.45781 3.90937C2.47656 3.74218 2.54063 3.58906 2.6375 3.46562L3.46406 2.63906C3.58906 2.54218 3.74063 2.47656 3.90781 2.45937C4.075 2.44218 4.2375 2.47187 4.37969 2.53906L5.67344 3.15312C5.85156 3.06874 6.03125 2.99374 6.21562 2.92812L6.69531 1.57968C6.74844 1.43124 6.84219 1.29374 6.97344 1.18749C7.10625 1.08124 7.25938 1.02031 7.41719 1.00156H8.57969C8.73594 1.02031 8.89062 1.08124 9.02344 1.18749C9.15625 1.29374 9.25 1.42968 9.30156 1.57968L9.78125 2.92812C9.96406 2.99374 10.1453 3.06718 10.3234 3.15312L11.6172 2.53906C11.7594 2.47187 11.9219 2.44062 12.0891 2.45937C12.2578 2.47812 12.4094 2.54218 12.5328 2.63906L13.3594 3.46562C13.4563 3.59062 13.5219 3.74218 13.5391 3.90937C13.5562 4.07656 13.5266 4.23906 13.4594 4.38124L12.8453 5.67499C12.9297 5.85156 13.0047 6.03281 13.0703 6.21562L14.4187 6.69531C14.5672 6.74843 14.7047 6.84218 14.8109 6.97343C14.9172 7.10468 14.9781 7.25937 14.9969 7.41718V8.58124C14.9781 8.73749 14.9172 8.89218 14.8109 9.02499C14.7047 9.15781 14.5687 9.25156 14.4187 9.30312L13.0703 9.78281C13.0047 9.96562 12.9312 10.1469 12.8453 10.325L13.4594 11.6187C13.5266 11.7609 13.5578 11.9234 13.5391 12.0906C13.5203 12.2594 13.4563 12.4109 13.3594 12.5344L12.5328 13.3609C12.4078 13.4578 12.2563 13.5234 12.0891 13.5406C11.9203 13.5594 11.7594 13.5281 11.6172 13.4609L10.3234 12.8469C10.1453 12.9312 9.96562 13.0062 9.78125 13.0719L9.30313 14.4219C9.25 14.5703 9.15625 14.7078 9.025 14.8141C8.89219 14.9203 8.73906 14.9812 8.58125 15H7.41875C7.2625 14.9812 7.10781 14.9203 6.975 14.8141C6.84219 14.7078 6.74844 14.5719 6.69688 14.4219L6.21719 13.0734C6.03437 13.0078 5.85313 12.9344 5.675 12.8484L4.38125 13.4625C4.23906 13.5297 4.07656 13.5609 3.90937 13.5422C3.74219 13.5234 3.58906 13.4594 3.46563 13.3625L2.63906 12.5359C2.54219 12.4109 2.47656 12.2594 2.45937 12.0922C2.44062 11.9234 2.47187 11.7625 2.53906 11.6203L3.15313 10.3266C3.06875 10.1484 2.99375 9.96874 2.92812 9.78437L1.57812 9.30312C1.42969 9.24999 1.29219 9.15624 1.18594 9.02499C1.07969 8.89218 1.01875 8.73906 1 8.58124V7.41718ZM1.87656 7.52031C1.84844 7.83749 1.84844 8.16249 1.87656 8.47812L3.63125 9.10156L3.69688 9.31249C3.77969 9.58749 3.89219 9.85468 4.02812 10.1125L4.13125 10.3078L3.33281 11.9891C3.54063 12.2312 3.76719 12.4594 4.01094 12.6672L5.69219 11.8687L5.8875 11.9719C6.14531 12.1078 6.4125 12.2203 6.6875 12.3031L6.89844 12.3687L7.52187 14.1234C7.67969 14.1375 7.83906 14.1453 8 14.1453C8.16094 14.1453 8.32031 14.1375 8.47812 14.1234L9.10156 12.3687L9.3125 12.3031C9.5875 12.2203 9.85469 12.1078 10.1125 11.9719L10.3078 11.8687L11.9891 12.6672C12.2312 12.4594 12.4594 12.2328 12.6672 11.9891L11.8687 10.3078L11.9719 10.1125C12.1078 9.85468 12.2203 9.58749 12.3031 9.31249L12.3687 9.10156L14.1234 8.47812C14.1516 8.16249 14.1516 7.83749 14.1234 7.52031L12.3687 6.89687L12.3031 6.68593C12.2203 6.41249 12.1078 6.14374 11.9719 5.88749L11.8687 5.69218L12.6672 4.01093C12.4594 3.76874 12.2328 3.54062 11.9891 3.33281L10.3078 4.13124L10.1125 4.02812C9.85469 3.89218 9.5875 3.77968 9.3125 3.69687L9.10156 3.63124L8.47812 1.87656C8.32031 1.86249 8.16094 1.85468 8 1.85468C7.83906 1.85468 7.67969 1.86249 7.52187 1.87656L6.89844 3.63124L6.6875 3.69687C6.4125 3.77968 6.14531 3.89218 5.8875 4.02812L5.69219 4.13124L4.01094 3.33281C3.76875 3.54062 3.54063 3.76718 3.33281 4.01093L4.13125 5.69218L4.02812 5.88749C3.89219 6.14374 3.77969 6.41249 3.69688 6.68593L3.63125 6.89687L1.87656 7.52031Z"
                      fill="currentColor"
                    />
                    <path
                      d="M8 6.03125C9.08594 6.03125 9.96875 6.91406 9.96875 8C9.96875 9.08594 9.08594 9.96875 8 9.96875C6.91406 9.96875 6.03125 9.08594 6.03125 8C6.03125 6.91406 6.91406 6.03125 8 6.03125ZM8 5.15625C6.42969 5.15625 5.15625 6.42969 5.15625 8C5.15625 9.57031 6.42969 10.8438 8 10.8438C9.57031 10.8438 10.8438 9.57031 10.8438 8C10.8438 6.42969 9.57031 5.15625 8 5.15625Z"
                      fill="currentColor"
                    />
                  </svg>
                  <span style="margin-left: 8px">
                    {{ i18n.navigateMenu.setting }}
                  </span>
                </el-menu-item>
              </router-link>
            </el-menu>
          </el-scrollbar>
        </el-aside>

        <el-main style="height: calc(100vh - 76px); padding: 0">
          <el-scrollbar style="padding: 0 20px">
            <router-view />
          </el-scrollbar>
        </el-main>
      </el-container>
    </div>
  </el-config-provider>
</template>

<style scoped></style>
